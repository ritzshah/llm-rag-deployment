{{- if .Values.enabled }}
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    argocd.argoproj.io/hook: PreSync
  name: check-default-storageclass-minio
  namespace: redhat-ods-operator
spec:
  template:
    spec:
      containers:
      - command:
        - /bin/sh
        - -c
        - "while true; do\necho \"Checking default StorageClass...\"\nSC=$(oc get\
          \ StorageClass ocs-storagecluster-ceph-rbd -o jsonpath='{.metadata.annotations.storageclass\\\
          .kubernetes\\.io/is-default-class}')\nif [ \"$SC\" = \"true\" ]; then\n\
          \  echo \"Storage class is ready.\"\n  exit 0\nelse\n  echo \"Storage class\
          \ is not ready yet.\"\nfi\nsleep 5\ndone\n"
        image: image-registry.openshift-image-registry.svc:5000/openshift/tools:latest
        name: phase-check
      restartPolicy: Never
      serviceAccountName: presync-monitoring-sa
{{- end }}
